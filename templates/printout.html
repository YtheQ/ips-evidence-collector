<div id="printout-header">
    <img src="https://brand.wisc.edu/content/uploads/2016/11/uw-crest-color-300x180.png" />
    <h1>&lt; Name of Tool &gt; - Investigation Report</h1>
    <table border="0">
        <tbody>
            <tr>
                <th align="left">Time of investigation:</th>
                <td>{{current_time}}</td>
            </tr>
            <tr>
                <th align="left">Client name:</th>
                <td>{{device_owner}}</td>
            </tr>
            <tr>
                <th align="left">Consultant name:</th>
                <td>{{consultant}}</td>
            </tr>
            <tr>
                <th align="left">Device analyzed:</th>
                <td>{{device}} phone</td>
            </tr>
        </tbody>
    </table>
</div>

<div class="printout-summary">
    <h1>Summary of findings</h1>
    <hr />
    <p>{{summary}}</p>
</div>

<h1>Detailed findings</h1>
<hr />
<h1>Spyware Apps</h1>
<div class="definition">
    <p>Spyware apps are apps purposefully designed for surveillance. When installed on someone's phone, they can allow
        the installer to view the phone owner's location, messages, calls, and/or a myriad of other data. </p>
</div>
<br>
{% if spyware|length > 0 %}
<table class="printout_columns">
    <tbody>
        {% for app in spyware %}
        <tr>
            <td>
                <h2>{{app.app_name}}</h2>
                <div class="appsummary">
                    <p><b>Investigation summary:</b> {{app.summary}}</p>
                </div>
                <h3>App information</h3>
                <table>
                    <tbody>
                        <tr>
                            <th>App description</th>
                            <td>{{app.description}}</td>
                        </tr>
                        <tr>
                            <th>Install time</th>
                            <td>{{app.install_time}}</td>
                        </tr>
                        <tr>
                            <th>Permissions requested</th>
                            <td>{% for perm in app.permissions %}{{perm.permission_name}}{{ ", " if not loop.last else
                                "" }}{% endfor %}</td>
                        </tr>
                        <tr>
                            <th>Recent permissions used</th>
                            <td>{% for perm in app.recent_permissions %}{{perm.permission_name}}{{ ", " if not loop.last
                                else "" }}{% endfor %}</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Investigation results</h3>
                {% with form = app.install_form %}
                <table>
                    <tbody>
                        <tr>
                            <th>Did the client know this app was installed?</th>
                            <td>{{form.knew_installed |
                                capitalize}}</td>
                        </tr>
                        <tr>
                            <th>Did the client install this app?</th>
                            <td>{{form.installed | capitalize}}</td>
                        </tr>
                        <tr>
                            <th>Was the client coerced into installing this app?</th>
                            <td>{{form.coerced |
                                capitalize}}</td>
                        </tr>
                    </tbody>
                </table>
                {% endwith %}
                <h3>Client comments</h3>
                <blockquote>
                    <p>
                        &gt; {% if app.notes.client_notes %}{{app.notes.client_notes}} {%
                        else %}None. {% endif %}
                    </p>
                </blockquote>
                <h3>Consultant comments</h3>
                <blockquote>
                    <p>
                        &gt; {% if app.notes.consultant_notes
                        %}{{app.notes.consultant_notes}} {% else %}None. {% endif %}
                    </p>
                </blockquote>
            </td>
            <td valign="top" class="screenshot">
                <img src="{{screenshot_dir}}test-screenshot.jpeg" />
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}

<h1>Dual-Use Apps</h1>
<div class="definition">
    <p>Dual-use apps are apps designed for a legitimate purpose, such as theft prevention. However, they have
        capabilities which can be misused to surveil the owner of the phone.</p>
</div>
<br>
{% if dualuse|length > 0 %}
<table class="printout_columns">
    <tbody>
        {% for app in dualuse %}
        <tr>
            <td>
                <h2>{{app.app_name}}</h2>
                <div class="appsummary">
                    <p><b>Investigation summary:</b> {{app.summary}}</p>
                </div>
                <h3>App information</h3>
                <table>
                    <tbody>
                        <tr>
                            <th>App description</th>
                            <td>{{app.description}}</td>
                        </tr>
                        <tr>
                            <th>Install time</th>
                            <td>{{app.install_time}}</td>
                        </tr>
                        <tr>
                            <th>Permissions requested</th>
                            <td>{% for perm in app.permissions %}{{perm.permission_name}}{{ ", " if not loop.last else
                                "" }}{% endfor %}</td>
                        </tr>
                        <tr>
                            <th>Recent permissions used</th>
                            <td>{% for perm in app.recent_permissions %}{{perm.permission_name}}{{ ", " if not loop.last
                                else "" }}{% endfor %}</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Investigation details</h3>
                <table>
                    <tbody>
                        {% with form = app.install_form %}
                        <tr>
                            <th>Did the client know this app was installed?</th>
                            <td>{{form.knew_installed |
                                capitalize}}</td>
                        </tr>
                        <tr>
                            <th>Did the client install this app?</th>
                            <td>{{form.installed | capitalize}}</td>
                        </tr>
                        <tr>
                            <th>Was the client coerced into installing this app?</th>
                            <td>{{form.coerced |
                                capitalize}}</td>
                        </tr>
                        {% endwith %}
                        {% for permission in app.permissions %}
                        <tr>
                            <th>Can the [ex-]partner access the client's
                                {{permission.permission_name.lower()}} using this app?</th>
                            <td>{{permission.access | capitalize}}</td>
                        </tr>
                        {% if permission.describe %}
                        <tr>
                            <th>How can the [ex-]partner access the client's {{permission.permission_name.lower()}}?</th>
                            <td>"{{permission.describe}}"</td>
                        </tr>
                        {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
                <h3>Client comments</h3>
                <blockquote>
                    <p>
                        &gt; {% if app.notes.client_notes %}{{app.notes.client_notes}} {%
                        else %}None. {% endif %}
                    </p>
                </blockquote>
                <h3>Consultant comments</h3>
                <blockquote>
                    <p>
                        &gt; {% if app.notes.client_notes %}{{app.notes.client_notes}} {%
                        else %}None. {% endif %}
                    </p>
                </blockquote>
            </td>
            <td valign="top" class="screenshot">
                <img src="{{screenshot_dir}}test-screenshot.jpeg" />
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}

<h1>Account Check</h1>
{% if accounts|length > 0 %}
<table class="printout_columns">
    <tbody>
        {% for account in accounts %}
        <tr>
            <td>
                <h2>{{account.account_name}}</h2>
                <div class="appsummary">
                    <p><b>Investigation summary:</b> {{account.summary}}</p>
                </div>
                <h3>Login activity check</h3>
                <table>
                    <tbody>
                        {% with form = account.suspicious_logins %}
                        <tr>
                            <th>Does the client recognize all devices logged into the account?</th>
                            <td>{{form.recognize | capitalize}}</td>
                        </tr>
                        {% if form.describe_logins %}
                        <tr>
                            <th>Which devices are suspicious?</th>
                            <td>"{{form.describe_logins}}"</td>
                        </tr>
                        {% endif %}
                        <tr>
                            <th>Are there any suspicious logins in the activity log?</th>
                            <td>{{form.activity_log | capitalize}}</td>
                        </tr>
                        {% if form.describe_activity %}
                        <tr>
                            <th>Which logins are suspicious and why?</th>
                            <td>"{{form.describe_activity}}"</td>
                        </tr>
                        {% endif %}
                        {% endwith %}
                    </tbody>
                </table>
                <h3>Password check</h3>
                <table>
                    <tbody>
                        {% with form = account.password_check %}
                        <tr>
                            <th>Does the [ex-]partner know the password to this
                                account?</th>
                            <td>{{form.know | capitalize}}</td>
                        </tr>
                        <tr>
                            <th>Does the client believe the [ex-]partner could guess the password to
                                this account?</th>
                            <td>{{form.guess | capitalize}}</td>
                        </tr>
                        {% endwith %}
                    </tbody>
                </table>
                <h3>Recovery settings check</h3>
                <table>
                    <tbody>
                        {% with form = account.recovery_settings %}
                        <tr>
                            <th>Is there a recovery phone number?</th>
                            <td>{{form.phone_present | capitalize}}</td>
                        </tr>
                        {% if form.phone_present != 'no' %}
                        <tr>
                            <th>(ADD) What is the recovery phone number?</th>
                            <td>"123-456-7890"</td>
                        </tr>
                        <tr>
                            <th>Could the [ex-]partner have access to this recovery phone number?</th>
                            <td>{{form.phone_access | capitalize}}</td>
                        </tr>
                        {% endif %}
                        <tr>
                            <th>Is there a recovery email address?</th>
                            <td>{{form.email_present | capitalize}}</td>
                        </tr>
                        {% if form.email_present != 'no' %}
                        <tr>
                            <th>(ADD) What is the recovery email address?</th>
                            <td>"email@email.com"</td>
                        </tr>
                        <tr>
                            <th>Could the [ex-]partner have access to this recovery email address?</th>
                            <td>{{form.email_access | capitalize}}</td>
                        </tr>
                        {% endif %}
                        {% endwith %}
                    </tbody>
                </table>
                <h3>Two-factor authentication check</h3>
                <table>
                    <tbody>
                        {% with form = account.two_factor_settings %}
                        <tr>
                            <th>Is two-factor authentication enabled?</th>
                            <td>{{form.enabled | capitalize}}</td>
                        </tr>
                        {% if form.enabled != 'no' %}
                        <tr>
                            <th>What type of two-factor authentication is it?</th>
                            <td>{{form.second_factor_type |
                                capitalize}}</td>
                        </tr>
                        <tr>
                            <th>Could the [ex-]partner have access to this second factor?</th>
                            <td>{{form.second_factor_access | capitalize}}</td>
                        </tr>
                        {% endif %}
                        {% endwith %}
                    </tbody>
                </table>
                <h3>Security questions check</h3>
                <table>
                    <tbody>{% with form = account.security_questions %}
                        <tr>
                            <th>Does the account use security questions?</th>
                            <td>{{form.present | capitalize}}</td>
                        </tr>
                        {% if form.present != 'no' %}
                        <tr>
                            <th>Which questions are set?</th>
                            <td>{{form.questions | capitalize}}</td>
                        </tr>
                        <tr>
                            <th>Would the [ex-]partner know the answers to any of the questions?</th>
                            <td>{{form.know | capitalize}}</td>
                        </tr>
                        {% endif %}
                        {% endwith %}
                    </tbody>
                </table>
                <h3>Client comments</h3>
                <blockquote>
                    <p>
                        &gt; {% if account.notes.client_notes
                        %}{{account.notes.client_notes}} {% else %}None. {% endif %}
                    </p>
                </blockquote>
                <h3>Consultant comments</h3>
                <blockquote>
                    <p>
                        &gt; {% if account.notes.client_notes
                        %}{{account.notes.client_notes}} {% else %}None. {% endif %}
                    </p>
                </blockquote>
            </td>
            <td valign="top" class="screenshot">
                <img src="{{screenshot_dir}}test-screenshot.jpeg" />
            </td>
        </tr>
        <tr></tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}

<hr />
<p>
    <em>&lt;Name of tool&gt; Investigation Report. &copy; Madison Tech Clinic,
        University of Wisconsin Madison.</em>
</p>